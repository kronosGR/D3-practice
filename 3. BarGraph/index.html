<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bar Graph</title>
</head>

<body>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    const data = [55, 44, 30, 23, 17, 14, 16, 25, 41, 61, 85,
      101, 95, 105, 114, 150, 180, 210, 125, 100, 71,
      75, 72, 67
    ];

    const barWidth = 15;
    const barPadding = 3;

    const maxValue = d3.max(data)

    // calculate x and y
    const xloc = (d, i) => i * (barWidth + barPadding);
    const yloc = (d) => maxValue - d;

    // translator to position each bar
    const translator = (d, i) => {
      return `translate(${xloc(d,i)}, ${yloc(d)})`
    };

    const textTranslator = `translate(${barWidth/2}, 1120)`

    var graphGroup = d3.select('body')
      .append('svg')
      .attr('width', '1000')
      .attr('height', '1000')
      .append('g');

    // add groups and bars
    const barGroups = graphGroup.selectAll('g')
      .data(data)
      .enter()
      .append('g')
      .attr('transform', translator)

    barGroups.append('rect')
      .attr({
        fill: 'black',
        width: barWidth,
        height: (d) => d
      });

    // add text in the groups
    barGroups.append('text')
      .text((d) => d)
      .attr({
        fill: 'white',
        'alignment-baseline': 'before-edge',
        'text-anchor': 'middle',
        transform: textTranslator
      })
      .style('font', '10px sans-serif')
  </script>
</body>

</html>